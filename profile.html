<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STAY DEPLOYABLE</title>
    <link rel="icon" type="image/png" href="flag.png">
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/parse/dist/parse.min.js"></script>
    <script>
        // Prevent scroll jump - restore position immediately
        (function() {
            if ('scrollRestoration' in history) {
                history.scrollRestoration = 'manual';
            }
            var savedPosition = sessionStorage.getItem('scrollPosition');
            if (savedPosition !== null) {
                var pos = parseInt(savedPosition);
                // Set scroll position on both window and document
                if (document.documentElement) {
                    document.documentElement.scrollTop = pos;
                }
                if (document.body) {
                    document.body.scrollTop = pos;
                }
                window.scrollTo(0, pos);
                // Also set after a microtask to ensure it sticks
                setTimeout(function() {
                    window.scrollTo(0, pos);
                    if (document.documentElement) {
                        document.documentElement.scrollTop = pos;
                    }
                }, 0);
            }
        })();
    </script>
</head>
<body>
    <div class="main-layout">
        <!-- Top Section -->
        <div class="top-section">
            <div class="top-left">
                <h2 class="deployable-question">Are you deployable?</h2>
            </div>
            <div class="top-right">
                <h1 class="main-title">STAY DEPLOYABLE</h1>
                <div class="image-placeholders">
                    <!-- Image 1: airforce.png - Position: grid-column 1, grid-row 1 -->
                    <div class="image-wrapper">
                        <img src="images/airforce.png" alt="Air Force" class="image-circle">
                    </div>
                    <!-- Image 2: IWO.png - Position: grid-column 3, grid-row 1 -->
                    <div class="image-wrapper">
                        <img src="images/IWO.png" alt="IWO" class="image-circle">
                    </div>
                    <!-- Image 3: marine.png - Position: grid-column 5, grid-row 1 -->
                    <div class="image-wrapper">
                        <img src="images/marine.png" alt="Marine" class="image-circle">
                    </div>
                    <!-- Image 4: navy.png - Position: grid-column 2, grid-row 2 -->
                    <div class="image-wrapper">
                        <img src="images/navy.png" alt="Navy" class="image-circle">
                    </div>
                    <!-- Image 5: ship.png - Position: grid-column 4, grid-row 2 -->
                    <div class="image-wrapper">
                        <img src="images/ship.png" alt="Ship" class="image-circle">
                    </div>
                    <!-- Image 6: helo.png -->
                    <div class="image-wrapper">
                        <img src="images/helo.png" alt="Helo" class="image-circle">
                    </div>
                    <!-- Image 7: helping.png -->
                    <div class="image-wrapper">
                        <img src="images/helping.png" alt="Helping" class="image-circle">
                    </div>
                    <!-- Image 8: usnavy.png -->
                    <div class="image-wrapper">
                        <img src="images/usnavy.png" alt="US Navy" class="image-circle">
                    </div>
                </div>
            </div>
        </div>

        <!-- Horizontal Divider -->
        <div class="horizontal-divider"></div>

        <!-- Bottom Section -->
        <div class="bottom-section">
            <div class="bottom-left">
                <p class="weeks-vet-label">This week's Veteran:</p>
                <div class="weeks-vet-content">
                    <!-- Space reserved for dynamic content -->
                </div>
            </div>
            <div class="vertical-divider"></div>
            <div class="bottom-right">
                <nav class="section-navbar">
                    <div class="section-nav-links">
                        <a href="index.html" class="section-nav-link">HOME</a>
                        <span class="nav-divider">|</span>
                        <a href="about.html" class="section-nav-link">ABOUT US</a>
                        <span class="nav-divider">|</span>
                        <a href="profile.html" class="section-nav-link">PROFILE</a>
                        <span class="nav-divider">|</span>
                        <a href="standards.html" class="section-nav-link">STANDARDS</a>
                        <span class="nav-divider">|</span>
                        <a href="#" class="section-nav-link" id="logoutLink">LOGOUT</a>
                    </div>
                </nav>
                <div id="profileContent" class="profile-content">
            <!-- View Mode -->
            <div id="profileView" class="profile-view">
                <div class="profile-info">
                    <div class="info-item">
                        <span class="info-label">First Name:</span>
                        <span id="viewFirstName" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Last Name:</span>
                        <span id="viewLastName" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Username:</span>
                        <span id="viewUsername" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">MOS/Rate/Designator:</span>
                        <span id="viewMOS" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Why you signed up:</span>
                        <p id="viewWhySignup" class="info-value-text"></p>
                    </div>
                </div>
                <div class="profile-actions">
                    <button id="editButton" class="profile-button edit-button">Edit Profile</button>
                    <button id="deleteButton" class="profile-button delete-button">Delete Account</button>
                </div>
            </div>

            <!-- Edit Mode -->
            <div id="profileEdit" class="profile-edit" style="display: none;">
                <form id="profileEditForm" class="profile-edit-form">
                    <div class="form-group">
                        <label for="editFirstName">First Name</label>
                        <input type="text" id="editFirstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="editLastName">Last Name</label>
                        <input type="text" id="editLastName" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="editMOS">MOS/Rate/Designator</label>
                        <input type="text" id="editMOS" name="mos" required>
                    </div>
                    <div class="form-group">
                        <label for="editWhySignup">Why are you signing up for this?</label>
                        <textarea id="editWhySignup" name="whySignup" rows="4" required></textarea>
                    </div>
                    <div id="profileErrorMessage" class="error-message" style="display: none;"></div>
                    <div class="profile-edit-actions">
                        <button type="submit" class="profile-button save-button">Save Changes</button>
                        <button type="button" id="cancelButton" class="profile-button cancel-button">Cancel</button>
                    </div>
                </form>
            </div>
            <!-- Custom scrollbar - positioned outside scrollable content -->
            <div class="custom-scrollbar">
                <div class="scrollbar-track">
                    <div class="scrollbar-thumb" id="scrollbarThumb"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="script.js"></script>
    <script src="profile.js"></script>
    <script>
        // Check authentication on page load
        document.addEventListener('DOMContentLoaded', function() {
            requireAuth();
            
            // Wait for Parse to be initialized, then load profile
            function waitForParseAndLoad() {
                if (typeof Parse !== 'undefined' && Parse.User.current()) {
                    loadProfile();
                } else if (typeof Parse === 'undefined') {
                    setTimeout(waitForParseAndLoad, 100);
                } else {
                    // Parse is loaded but no user - should have been redirected by requireAuth
                    console.log('No user found after authentication check');
                }
            }
            
            waitForParseAndLoad();
            
            // Add logout functionality to section navbar
            const logoutLink = document.getElementById('logoutLink');
            if (logoutLink) {
                logoutLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (typeof logout === 'function') {
                        logout();
                    }
                });
            }
        });
    </script>
</body>
</html>
